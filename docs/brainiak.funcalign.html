

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>brainiak.funcalign package &mdash; brainiak 0.11 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="brainiak.hyperparamopt package" href="brainiak.hyperparamopt.html" />
    <link rel="prev" title="brainiak.fcma package" href="brainiak.fcma.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> brainiak
          

          
          </a>

          
            
            
              <div class="version">
                0.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">brainiak</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="api.html">API</a> &raquo;</li>
        
          <li><a href="brainiak.html">brainiak package</a> &raquo;</li>
        
      <li>brainiak.funcalign package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/brainiak.funcalign.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-brainiak.funcalign">
<span id="brainiak-funcalign-package"></span><h1>brainiak.funcalign package<a class="headerlink" href="#module-brainiak.funcalign" title="Permalink to this headline">¶</a></h1>
<p>Functional alignment of volumes from different subjects.</p>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-brainiak.funcalign.fastsrm">
<span id="brainiak-funcalign-fastsrm-module"></span><h2>brainiak.funcalign.fastsrm module<a class="headerlink" href="#module-brainiak.funcalign.fastsrm" title="Permalink to this headline">¶</a></h2>
<p>Fast Shared Response Model (FastSRM)</p>
<p>The implementation is based on the following publications:</p>
<dl class="citation">
<dt class="label" id="richard2019"><span class="brackets"><a class="fn-backref" href="#id1">Richard2019</a></span></dt>
<dd><p>“Fast Shared Response Model for fMRI data”
H. Richard, L. Martin, A. Pinho, J. Pillow, B. Thirion, 2019
<a class="reference external" href="https://arxiv.org/pdf/1909.12537.pdf">https://arxiv.org/pdf/1909.12537.pdf</a></p>
</dd>
</dl>
<dl class="py class">
<dt id="brainiak.funcalign.fastsrm.FastSRM">
<em class="property">class </em><code class="sig-prename descclassname">brainiak.funcalign.fastsrm.</code><code class="sig-name descname">FastSRM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atlas</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_components</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">temp_dir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">low_ram</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_jobs</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">'warn'</span></em>, <em class="sig-param"><span class="n">aggregate</span><span class="o">=</span><span class="default_value">'mean'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>SRM decomposition using a very low amount of memory and computational power thanks to the use of an atlas as described in <a class="reference internal" href="#richard2019" id="id1"><span>[Richard2019]</span></a>.</p>
<p>Given multi-subject data, factorize it as a shared response S among all subjects and an orthogonal transform (basis) W per subject:</p>
<div class="math notranslate nohighlight">
\[X_i \approx W_i S, \forall i=1 \dots N\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atlas</strong> (<em>array</em><em>, </em><em>shape=</em><em>[</em><em>n_supervoxels</em><em>, </em><em>n_voxels</em><em>] or </em><em>array</em><em>,</em><em>shape=</em><em>[</em><em>n_voxels</em><em>] or </em><em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Probabilistic or deterministic atlas on which to project the data. Deterministic atlas is an array of shape [n_voxels,] where values range from 1 to n_supervoxels. Voxels labelled 0 will be ignored. If atlas is a str the corresponding array is loaded with numpy.load and expected shape is (n_voxels,) for a deterministic atlas and (n_supervoxels, n_voxels) for a probabilistic atlas.</p></li>
<li><p><strong>n_components</strong> (<em>int</em>) – Number of timecourses of the shared coordinates</p></li>
<li><p><strong>n_iter</strong> (<em>int</em>) – Number of iterations to perform</p></li>
<li><p><strong>temp_dir</strong> (<em>str</em><em> or </em><em>None</em>) – Path to dir where temporary results are stored. If None temporary results will be stored in memory. This can results in memory errors when the number of subjects and/or sessions is large</p></li>
<li><p><strong>low_ram</strong> (<em>bool</em>) – If True and temp_dir is not None, reduced_data will be saved on disk. This increases the number of IO but reduces memory complexity when the number of subject and/or sessions is large</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Seed used for random sampling.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1</em>) – The number of CPUs to use to do the computation. -1 means all CPUs, -2 all CPUs but one, and so on.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> or </em><em>&quot;warn&quot;</em>) – If True, logs are enabled. If False, logs are disabled. If “warn” only warnings are printed.</p></li>
<li><p><strong>aggregate</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=&quot;mean&quot;</em>) – If “mean”, shared_response is the mean shared response from all subjects. If None, shared_response contains all subject-specific responses in shared space</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt>
<code class="sig-name descname">`basis_list`</code></dt>
<dd><ul class="simple">
<li><p>if basis is a list of array, element i is the basis of subject i</p></li>
<li><p>if basis is a list of str, element i is the path to the basis of subject i that is loaded with np.load yielding an array of shape [n_components, n_voxels].</p></li>
</ul>
<p>Note that any call to the clean method erases this attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[n_components, n_voxels] or list of str</p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>References:</strong>
H. Richard, L. Martin, A. Pinho, J. Pillow, B. Thirion, 2019: Fast shared response model for fMRI data (<a class="reference external" href="https://arxiv.org/pdf/1909.12537.pdf">https://arxiv.org/pdf/1909.12537.pdf</a>)</p>
</div>
<dl class="py method">
<dt id="brainiak.funcalign.fastsrm.FastSRM.add_subjects">
<code class="sig-name descname">add_subjects</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imgs</span></em>, <em class="sig-param"><span class="n">shared_response</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM.add_subjects" title="Permalink to this definition">¶</a></dt>
<dd><p>Add subjects to the current fit. Each new basis will be appended at the end of the list of basis (which can be accessed using self.basis)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p></li>
<li><p><strong>shared_response</strong> (<em>list of arrays</em><em>, </em><em>list of list of arrays</em><em> or </em><em>array</em>) – <ul>
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.fastsrm.FastSRM.clean">
<code class="sig-name descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>This erases temporary files and basis_list attribute to free memory. This method should be called when fitted model is not needed anymore.</p>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.fastsrm.FastSRM.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imgs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes basis across subjects from input imgs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Returns the instance itself. Contains attributes listed at the object level.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.fastsrm.FastSRM.fit_transform">
<code class="sig-name descname">fit_transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imgs</span></em>, <em class="sig-param"><span class="n">subjects_indexes</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM.fit_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes basis across subjects and shared response from input imgs
return shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p></li>
<li><p><strong>subjects_indexes</strong> (<em>list</em><em> or </em><em>None:</em>) – if None imgs[i] will be transformed using basis_list[i]. Otherwise imgs[i] will be transformed using basis_list[subjects_index[i]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>shared_response</strong> –</p>
<ul class="simple">
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of arrays, list of list of arrays or array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.fastsrm.FastSRM.inverse_transform">
<code class="sig-name descname">inverse_transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">shared_response</span></em>, <em class="sig-param"><span class="n">subjects_indexes</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sessions_indexes</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM.inverse_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>From shared response and basis from training data
reconstruct subject’s data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shared_response</strong> (<em>list of arrays</em><em>, </em><em>list of list of arrays</em><em> or </em><em>array</em>) – <ul>
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p></li>
<li><p><strong>subjects_indexes</strong> (<em>list</em><em> or </em><em>None</em>) – if None reconstructs data of all subjects used during train. Otherwise reconstructs data of subjects specified by subjects_indexes.</p></li>
<li><p><strong>sessions_indexes</strong> (<em>list</em><em> or </em><em>None</em>) – if None reconstructs data of all sessions. Otherwise uses reconstructs data of sessions specified by sessions_indexes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>reconstructed_data</strong> –</p>
<ul class="simple">
<li><p>if reconstructed_data is a list of list : element i, j is the reconstructed data for subject subjects_indexes[i] and session sessions_indexes[j] as an np array of shape n_voxels, n_timeframes</p></li>
<li><p>if reconstructed_data is a list : element i is the reconstructed data for subject subject_indexes[i] as an np array of shape n_voxels, n_timeframes</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of list of arrays or list of arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.fastsrm.FastSRM.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">imgs</span></em>, <em class="sig-param"><span class="n">subjects_indexes</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.fastsrm.FastSRM.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>From data in imgs and basis from training data,
computes shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>imgs</strong> (<em>array of str</em><em>, </em><em>shape=</em><em>[</em><em>n_subjects</em><em>, </em><em>n_sessions</em><em>] or </em><em>list of list of arrays</em><em> or </em><em>list of arrays</em>) – <p>Element i, j of the array is a path to the data of subject i collected during session j. Data are loaded with numpy.load and expected shape is [n_voxels, n_timeframes] n_timeframes and n_voxels are assumed to be the same across subjects n_timeframes can vary across sessions. Each voxel’s timecourse is assumed to have mean 0 and variance 1</p>
<p>imgs can also be a list of list of arrays where element i, j of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i collected during session j.</p>
<p>imgs can also be a list of arrays where element i of the array is a numpy array of shape [n_voxels, n_timeframes] that contains the data of subject i (number of sessions is implicitly 1)</p>
</p></li>
<li><p><strong>subjects_indexes</strong> (<em>list</em><em> or </em><em>None:</em>) – if None imgs[i] will be transformed using basis_list[i]. Otherwise imgs[i] will be transformed using basis[subjects_index[i]]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>shared_response</strong> –</p>
<ul class="simple">
<li><p>if imgs is a list of array and self.aggregate=”mean”: shared response is an array of shape (n_components, n_timeframes)</p></li>
<li><p>if imgs is a list of array and self.aggregate=None: shared response is a list of array, element i is the projection of data of subject i in shared space.</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=”mean”: shared response is a list of array, element j is the shared response during session j</p></li>
<li><p>if imgs is an array or a list of list of array and self.aggregate=None: shared response is a list of list of array, element i, j is the projection of data of subject i collected during session j in shared space.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of arrays, list of list of arrays or array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-brainiak.funcalign.rsrm">
<span id="brainiak-funcalign-rsrm-module"></span><h2>brainiak.funcalign.rsrm module<a class="headerlink" href="#module-brainiak.funcalign.rsrm" title="Permalink to this headline">¶</a></h2>
<p>Robust Shared Response Model (RSRM)</p>
<p>The implementation is based on the following publications:</p>
<dl class="citation">
<dt class="label" id="turek2017"><span class="brackets">Turek2017</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>)</span></dt>
<dd><p>“Capturing Shared and Individual Information in fMRI Data”,
J. Turek, C. Ellis, L. Skalaban, N. Turk-Browne, T. Willke
under review, 2017.</p>
</dd>
</dl>
<dl class="py class">
<dt id="brainiak.funcalign.rsrm.RSRM">
<em class="property">class </em><code class="sig-prename descclassname">brainiak.funcalign.rsrm.</code><code class="sig-name descname">RSRM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">features</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">gamma</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">rand_seed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Robust Shared Response Model (RSRM)</p>
<p>Given multi-subject data, factorize it as a shared response R among all
subjects, an orthogonal transform W per subject, and an individual
(outlying) sparse component S per subject:</p>
<div class="math notranslate nohighlight">
\[X_i \approx W_i R + S_i, \forall i=1 \dots N\]</div>
<p>This unsupervised model allows to learn idiosyncratic information for
subjects and simultaneously improve the shared response estimation.
The model has similar properties to the Shared Response Model (SRM) with
the addition of the individual components.</p>
<p>The model is estimated solving the following optimization problem:</p>
<div class="math notranslate nohighlight">
\[\min_{W_i, S_i, R}\sum_i \frac{1}{2}\|X_i - W_i R - S_i\|_F^2\]</div>
<div class="math notranslate nohighlight">
\[+ \gamma\|S_i\|_1\]</div>
<div class="math notranslate nohighlight">
\[s.t. \qquad W_i^TW_i = I \quad \forall i=1 \dots N\]</div>
<p>The solution to this problem is obtained by applying a Block-Coordinate
Descent procedure. More details can be found in <a class="reference internal" href="#turek2017" id="id2"><span>[Turek2017]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iter</strong> (<em>int</em><em>, </em><em>default: 10</em>) – Number of iterations to run the algorithm.</p></li>
<li><p><strong>features</strong> (<em>int</em><em>, </em><em>default: 50</em>) – Number of features to compute.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>default: 1.0</em>) – Regularization parameter for the sparseness of the individual
components. Higher values yield sparser individual components.</p></li>
<li><p><strong>rand_seed</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Seed for initializing the random number generator.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="brainiak.funcalign.rsrm.RSRM.w_">
<code class="sig-name descname">w_</code><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.w_" title="Permalink to this definition">¶</a></dt>
<dd><p>The orthogonal transforms (mappings) for each subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[voxels_i, features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.rsrm.RSRM.r_">
<code class="sig-name descname">r_</code><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.r_" title="Permalink to this definition">¶</a></dt>
<dd><p>The shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[features, timepoints]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.rsrm.RSRM.s_">
<code class="sig-name descname">s_</code><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.s_" title="Permalink to this definition">¶</a></dt>
<dd><p>The individual components for each subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[voxels_i, timepoints]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.rsrm.RSRM.random_state_">
<code class="sig-name descname">random_state_</code><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.random_state_" title="Permalink to this definition">¶</a></dt>
<dd><p>Random number generator initialized using rand_seed</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomState</span></code></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of voxels may be different between subjects. However, the
number of timepoints for the alignment data must be the same across
subjects.</p>
<p>The Robust Shared Response Model is approximated using the
Block-Coordinate Descent (BCD) algorithm proposed in <a class="reference internal" href="#turek2017" id="id3"><span>[Turek2017]</span></a>.</p>
<p>This is a single node version.</p>
</div>
<dl class="py method">
<dt id="brainiak.funcalign.rsrm.RSRM.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Robust Shared Response Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>timepoints</em><em>]</em>) – Each element in the list contains the fMRI data of one subject.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.rsrm.RSRM.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the model to transform new data to Shared Response space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>timepoints_i</em><em>]</em>) – Each element in the list contains the fMRI data of one subject.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>r</strong> (<em>list of 2D arrays, element i has shape=[features_i, timepoints_i]</em>) – Shared responses from input data (X)</p></li>
<li><p><strong>s</strong> (<em>list of 2D arrays, element i has shape=[voxels_i, timepoints_i]</em>) – Individual data obtained from fitting model to input data (X)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.rsrm.RSRM.transform_subject">
<code class="sig-name descname">transform_subject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.rsrm.RSRM.transform_subject" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a new subject using the existing model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>2D array</em><em>, </em><em>shape=</em><em>[</em><em>voxels</em><em>, </em><em>timepoints</em><em>]</em>) – The fMRI data of the new subject.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>w</strong> (<em>2D array, shape=[voxels, features]</em>) – Orthogonal mapping <code class="xref py py-obj docutils literal notranslate"><span class="pre">W_{new}</span></code> for new subject</p></li>
<li><p><strong>s</strong> (<em>2D array, shape=[voxels, timepoints]</em>) – Individual term <code class="xref py py-obj docutils literal notranslate"><span class="pre">S_{new}</span></code> for new subject</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-brainiak.funcalign.srm">
<span id="brainiak-funcalign-srm-module"></span><h2>brainiak.funcalign.srm module<a class="headerlink" href="#module-brainiak.funcalign.srm" title="Permalink to this headline">¶</a></h2>
<p>Shared Response Model (SRM)</p>
<p>The implementations are based on the following publications:</p>
<dl class="citation">
<dt class="label" id="chen2015"><span class="brackets">Chen2015</span><span class="fn-backref">(<a href="#id4">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>“A Reduced-Dimension fMRI Shared Response Model”,
P.-H. Chen, J. Chen, Y. Yeshurun-Dishon, U. Hasson, J. Haxby, P. Ramadge
Advances in Neural Information Processing Systems (NIPS), 2015.
<a class="reference external" href="http://papers.nips.cc/paper/5855-a-reduced-dimension-fmri-shared-response-model">http://papers.nips.cc/paper/5855-a-reduced-dimension-fmri-shared-response-model</a></p>
</dd>
<dt class="label" id="anderson2016"><span class="brackets"><a class="fn-backref" href="#id6">Anderson2016</a></span></dt>
<dd><p>“Enabling Factor Analysis on Thousand-Subject Neuroimaging
Datasets”,
Michael J. Anderson, Mihai Capotă, Javier S. Turek, Xia Zhu, Theodore L.
Willke, Yida Wang, Po-Hsuan Chen, Jeremy R. Manning, Peter J. Ramadge,
Kenneth A. Norman,
IEEE International Conference on Big Data, 2016.
<a class="reference external" href="https://doi.org/10.1109/BigData.2016.7840719">https://doi.org/10.1109/BigData.2016.7840719</a></p>
</dd>
</dl>
<dl class="py class">
<dt id="brainiak.funcalign.srm.DetSRM">
<em class="property">class </em><code class="sig-prename descclassname">brainiak.funcalign.srm.</code><code class="sig-name descname">DetSRM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">features</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">rand_seed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Deterministic Shared Response Model (DetSRM)</p>
<p>Given multi-subject data, factorize it as a shared response S among all
subjects and an orthogonal transform W per subject:</p>
<div class="math notranslate nohighlight">
\[X_i \approx W_i S, \forall i=1 \dots N\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iter</strong> (<em>int</em><em>, </em><em>default: 10</em>) – Number of iterations to run the algorithm.</p></li>
<li><p><strong>features</strong> (<em>int</em><em>, </em><em>default: 50</em>) – Number of features to compute.</p></li>
<li><p><strong>rand_seed</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Seed for initializing the random number generator.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="brainiak.funcalign.srm.DetSRM.w_">
<code class="sig-name descname">w_</code><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM.w_" title="Permalink to this definition">¶</a></dt>
<dd><p>The orthogonal transforms (mappings) for each subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[voxels_i, features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.DetSRM.s_">
<code class="sig-name descname">s_</code><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM.s_" title="Permalink to this definition">¶</a></dt>
<dd><p>The shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[features, samples]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.DetSRM.random_state_">
<code class="sig-name descname">random_state_</code><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM.random_state_" title="Permalink to this definition">¶</a></dt>
<dd><p>Random number generator initialized using rand_seed</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomState</span></code></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of voxels may be different between subjects. However, the
number of samples must be the same across subjects.</p>
<p>The Deterministic Shared Response Model is approximated using the
Block Coordinate Descent (BCD) algorithm proposed in <a class="reference internal" href="#chen2015" id="id4"><span>[Chen2015]</span></a>.</p>
<p>This is a single node version.</p>
<p>The run-time complexity is <span class="math notranslate nohighlight">\(O(I (V T K + V K^2))\)</span> and the memory
complexity is <span class="math notranslate nohighlight">\(O(V T)\)</span> with I - the number of iterations, V - the
sum of voxels from all subjects, T - the number of samples, K - the
number of features (typically, <span class="math notranslate nohighlight">\(V \gg T \gg K\)</span>), and N - the
number of subjects.</p>
</div>
<dl class="py method">
<dt id="brainiak.funcalign.srm.DetSRM.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Deterministic Shared Response Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples</em><em>]</em>) – Each element in the list contains the fMRI data of one subject.</p></li>
<li><p><strong>y</strong> (<em>not used</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.srm.DetSRM.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the model to transform data to the Shared Response subspace</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples_i</em><em>]</em>) – Each element in the list contains the fMRI data of one subject.</p></li>
<li><p><strong>y</strong> (<em>not used</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s</strong> – Shared responses from input data (X)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of 2D arrays, element i has shape=[features_i, samples_i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.srm.DetSRM.transform_subject">
<code class="sig-name descname">transform_subject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.DetSRM.transform_subject" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a new subject using the existing model.
The subject is assumed to have recieved equivalent stimulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>2D array</em><em>, </em><em>shape=</em><em>[</em><em>voxels</em><em>, </em><em>timepoints</em><em>]</em>) – The fMRI data of the new subject.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>w</strong> – Orthogonal mapping <code class="xref py py-obj docutils literal notranslate"><span class="pre">W_{new}</span></code> for new subject</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array, shape=[voxels, features]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="brainiak.funcalign.srm.SRM">
<em class="property">class </em><code class="sig-prename descclassname">brainiak.funcalign.srm.</code><code class="sig-name descname">SRM</code><span class="sig-paren">(</span><em class="sig-param">n_iter=10</em>, <em class="sig-param">features=50</em>, <em class="sig-param">rand_seed=0</em>, <em class="sig-param">comm=&lt;mpi4py.MPI.Intracomm object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.SRM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Probabilistic Shared Response Model (SRM)</p>
<p>Given multi-subject data, factorize it as a shared response S among all
subjects and an orthogonal transform W per subject:</p>
<div class="math notranslate nohighlight">
\[X_i \approx W_i S, \forall i=1 \dots N\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iter</strong> (<em>int</em><em>, </em><em>default: 10</em>) – Number of iterations to run the algorithm.</p></li>
<li><p><strong>features</strong> (<em>int</em><em>, </em><em>default: 50</em>) – Number of features to compute.</p></li>
<li><p><strong>rand_seed</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Seed for initializing the random number generator.</p></li>
<li><p><strong>comm</strong> (<em>mpi4py.MPI.Intracomm</em>) – The MPI communicator containing the data</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.w_">
<code class="sig-name descname">w_</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.w_" title="Permalink to this definition">¶</a></dt>
<dd><p>The orthogonal transforms (mappings) for each subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[voxels_i, features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.s_">
<code class="sig-name descname">s_</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.s_" title="Permalink to this definition">¶</a></dt>
<dd><p>The shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[features, samples]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.sigma_s_">
<code class="sig-name descname">sigma_s_</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.sigma_s_" title="Permalink to this definition">¶</a></dt>
<dd><p>The covariance of the shared response Normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[features, features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.mu_">
<code class="sig-name descname">mu_</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.mu_" title="Permalink to this definition">¶</a></dt>
<dd><p>The voxel means over the samples for each subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[voxels_i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.rho2_">
<code class="sig-name descname">rho2_</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.rho2_" title="Permalink to this definition">¶</a></dt>
<dd><p>The estimated noise variance <span class="math notranslate nohighlight">\(\rho_i^2\)</span> for each subject</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[subjects]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.comm">
<code class="sig-name descname">comm</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.comm" title="Permalink to this definition">¶</a></dt>
<dd><p>The MPI communicator containing the data</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>mpi4py.MPI.Intracomm</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.srm.SRM.random_state_">
<code class="sig-name descname">random_state_</code><a class="headerlink" href="#brainiak.funcalign.srm.SRM.random_state_" title="Permalink to this definition">¶</a></dt>
<dd><p>Random number generator initialized using rand_seed</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomState</span></code></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of voxels may be different between subjects. However, the
number of samples must be the same across subjects.</p>
<p>The probabilistic Shared Response Model is approximated using the
Expectation Maximization (EM) algorithm proposed in <a class="reference internal" href="#chen2015" id="id5"><span>[Chen2015]</span></a>. The
implementation follows the optimizations published in <a class="reference internal" href="#anderson2016" id="id6"><span>[Anderson2016]</span></a>.</p>
<p>This is a single node version.</p>
<p>The run-time complexity is <span class="math notranslate nohighlight">\(O(I (V T K + V K^2 + K^3))\)</span> and the
memory complexity is <span class="math notranslate nohighlight">\(O(V T)\)</span> with I - the number of iterations,
V - the sum of voxels from all subjects, T - the number of samples, and
K - the number of features (typically, <span class="math notranslate nohighlight">\(V \gg T \gg K\)</span>).</p>
</div>
<dl class="py method">
<dt id="brainiak.funcalign.srm.SRM.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.SRM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the probabilistic Shared Response Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples</em><em>]</em>) – Each element in the list contains the fMRI data of one subject.</p></li>
<li><p><strong>y</strong> (<em>not used</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.srm.SRM.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.SRM.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save fitted SRM to .npz file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>str</em><em>, </em><em>file-like object</em><em>, or </em><em>pathlib.Path</em>) – Filename (string), open file (file-like object) or pathlib.Path
where the fitted SRM will be saved. If file is a string or a Path,
the .npz extension will be appended to the filename if it is not
already there.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.srm.SRM.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.SRM.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the model to transform matrix to Shared Response space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples_i</em><em>]</em>) – Each element in the list contains the fMRI data of one subject
note that number of voxels and samples can vary across subjects</p></li>
<li><p><strong>y</strong> (<em>not used</em><em> (</em><em>as it is unsupervised learning</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s</strong> – Shared responses from input data (X)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of 2D arrays, element i has shape=[features_i, samples_i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.srm.SRM.transform_subject">
<code class="sig-name descname">transform_subject</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.srm.SRM.transform_subject" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a new subject using the existing model.
The subject is assumed to have recieved equivalent stimulation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>2D array</em><em>, </em><em>shape=</em><em>[</em><em>voxels</em><em>, </em><em>timepoints</em><em>]</em>) – The fMRI data of the new subject.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>w</strong> – Orthogonal mapping <code class="xref py py-obj docutils literal notranslate"><span class="pre">W_{new}</span></code> for new subject</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2D array, shape=[voxels, features]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-brainiak.funcalign.sssrm">
<span id="brainiak-funcalign-sssrm-module"></span><h2>brainiak.funcalign.sssrm module<a class="headerlink" href="#module-brainiak.funcalign.sssrm" title="Permalink to this headline">¶</a></h2>
<p>Semi-Supervised Shared Response Model (SS-SRM)</p>
<p>The implementations are based on the following publications:</p>
<dl class="citation">
<dt class="label" id="turek2016"><span class="brackets">Turek2016</span><span class="fn-backref">(<a href="#id7">1</a>,<a href="#id8">2</a>)</span></dt>
<dd><p>“A Semi-Supervised Method for Multi-Subject fMRI Functional
Alignment”,
J. S. Turek, T. L. Willke, P.-H. Chen, P. J. Ramadge
IEEE International Conference on Acoustics, Speech and Signal Processing
(ICASSP), 2017, pp. 1098-1102.
<a class="reference external" href="https://doi.org/10.1109/ICASSP.2017.7952326">https://doi.org/10.1109/ICASSP.2017.7952326</a></p>
</dd>
</dl>
<dl class="py class">
<dt id="brainiak.funcalign.sssrm.SSSRM">
<em class="property">class </em><code class="sig-prename descclassname">brainiak.funcalign.sssrm.</code><code class="sig-name descname">SSSRM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n_iter</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">features</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">gamma</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">rand_seed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.BaseEstimator</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.ClassifierMixin</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sklearn.base.TransformerMixin</span></code></p>
<p>Semi-Supervised Shared Response Model (SS-SRM)</p>
<p>Given multi-subject data, factorize it as a shared response S among all
subjects and an orthogonal transform W per subject, using also labeled
data to train a Multinomial Logistic Regression (MLR) classifier (with
l2 regularization) in a semi-supervised manner:</p>
<div class="math notranslate nohighlight" id="equation-sssrm-eq">
<span class="eqno">(1)<a class="headerlink" href="#equation-sssrm-eq" title="Permalink to this equation">¶</a></span>\[(1-\alpha) Loss_{SRM}(W_i,S;X_i)
+ \alpha/\gamma Loss_{MLR}(\theta, bias; {(W_i^T \times Z_i, y_i})
+ R(\theta)\]</div>
<p>(see Equations (1) and (4) in <a class="reference internal" href="#turek2016" id="id7"><span>[Turek2016]</span></a>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_iter</strong> (<em>int</em><em>, </em><em>default: 10</em>) – Number of iterations to run the algorithm.</p></li>
<li><p><strong>features</strong> (<em>int</em><em>, </em><em>default: 50</em>) – Number of features to compute.</p></li>
<li><p><strong>gamma</strong> (<em>float</em><em>, </em><em>default: 1.0</em>) – Regularization parameter for the classifier.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>default: 0.5</em>) – Balance parameter between the SRM term and the MLR term.</p></li>
<li><p><strong>rand_seed</strong> (<em>int</em><em>, </em><em>default: 0</em>) – Seed for initializing the random number generator.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="brainiak.funcalign.sssrm.SSSRM.w_">
<code class="sig-name descname">w_</code><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.w_" title="Permalink to this definition">¶</a></dt>
<dd><p>The orthogonal transforms (mappings) for each subject.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of array, element i has shape=[voxels_i, features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.sssrm.SSSRM.s_">
<code class="sig-name descname">s_</code><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.s_" title="Permalink to this definition">¶</a></dt>
<dd><p>The shared response.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[features, samples]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.sssrm.SSSRM.theta_">
<code class="sig-name descname">theta_</code><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.theta_" title="Permalink to this definition">¶</a></dt>
<dd><p>The MLR class plane parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[classes, features]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.sssrm.SSSRM.bias_">
<code class="sig-name descname">bias_</code><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.bias_" title="Permalink to this definition">¶</a></dt>
<dd><p>The MLR class biases.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array, shape=[classes]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.sssrm.SSSRM.classes_">
<code class="sig-name descname">classes_</code><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.classes_" title="Permalink to this definition">¶</a></dt>
<dd><p>Mapping table for each classes to original class label.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array of int, shape=[classes]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="brainiak.funcalign.sssrm.SSSRM.random_state_">
<code class="sig-name descname">random_state_</code><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.random_state_" title="Permalink to this definition">¶</a></dt>
<dd><p>Random number generator initialized using rand_seed</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">RandomState</span></code></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The number of voxels may be different between subjects. However, the
number of samples for the alignment data must be the same across
subjects. The number of labeled samples per subject can be different.</p>
<p>The Semi-Supervised Shared Response Model is approximated using the
Block-Coordinate Descent (BCD) algorithm proposed in <a class="reference internal" href="#turek2016" id="id8"><span>[Turek2016]</span></a>.</p>
<p>This is a single node version.</p>
</div>
<dl class="py method">
<dt id="brainiak.funcalign.sssrm.SSSRM.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">Z</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Semi-Supervised Shared Response Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>n_align</em><em>]</em>) – Each element in the list contains the fMRI data for alignment of
one subject. There are n_align samples for each subject.</p></li>
<li><p><strong>y</strong> (<em>list of arrays of int</em><em>, </em><em>element i has shape=</em><em>[</em><em>samples_i</em><em>]</em>) – Each element in the list contains the labels for the data samples
in Z.</p></li>
<li><p><strong>Z</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples_i</em><em>]</em>) – Each element in the list contains the fMRI data of one subject
for training the MLR classifier.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.sssrm.SSSRM.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify the output for given data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples_i</em><em>]</em>) – Each element in the list contains the fMRI data of one subject
The number of voxels should be according to each subject at
the moment of training the model.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – Predictions for each data sample.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of arrays, element i has shape=[samples_i]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="brainiak.funcalign.sssrm.SSSRM.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#brainiak.funcalign.sssrm.SSSRM.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the model to transform matrix to Shared Response space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>list of 2D arrays</em><em>, </em><em>element i has shape=</em><em>[</em><em>voxels_i</em><em>, </em><em>samples_i</em><em>]</em>) – Each element in the list contains the fMRI data of one subject
note that number of voxels and samples can vary across subjects.</p></li>
<li><p><strong>y</strong> (<em>not used as it only applies the mappings</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>s</strong> – Shared responses from input data (X)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of 2D arrays, element i has shape=[features_i, samples_i]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="brainiak.hyperparamopt.html" class="btn btn-neutral float-right" title="brainiak.hyperparamopt package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="brainiak.fcma.html" class="btn btn-neutral float-left" title="brainiak.fcma package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016, Princeton Neuroscience Institute and Intel Corporation

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>